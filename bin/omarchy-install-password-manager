#!/bin/bash

if (($# == 0)); then
  echo "Usage: omarchy-install-password-manager [1password|bitwarden|keepassxc] [extra_packages]"
  exit 1
fi

package="$1"
package_extras="$2"

# Install package
omarchy-pkg-add $package $package_extras

if [ $package = "bitwarden" ]; then
  # Bitwarden package installs the executable with a different name
  ln -s /usr/bin/bitwarden-desktop /usr/bin/bitwarden
fi

# Set as default password manager
echo "Setting $package as new default password manager..."
sed -i "/export PASSWORD_MANAGER=/ c\export PASSWORD_MANAGER=$package" ~/.config/uwsm/default

# Relaunch is needed for new default to take effect
echo
gum confirm "Relaunch Hyprland to use new password manager?" && uwsm stop
